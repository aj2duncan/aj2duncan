<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="map[]" />
    <meta name="description" content="My personal webpage built through Hugo and blogdown.">
    <link rel="shortcut icon" type="image/x-icon" href="../../img/favicon.ico">
    <title>LaTeX Notation for Scientific Notation in ggplot2</title>
    <meta name="generator" content="Hugo 0.92.1" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link href='https://fonts.googleapis.com/css?family=Indie+Flower|Alegreya|Alegreya+Sans' rel='stylesheet'>
    <link rel="stylesheet" type="text/css" href="../../css/main.css" /><link href="//cdn.bootcss.com/highlight.js/9.12.0/styles/github.min.css" rel="stylesheet">
    
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,400,200bold,400old" />
    
    <link rel="stylesheet" href="../../css/custom.css">
    
    <link rel="stylesheet" href="../../css/custom_leaflet.css">
    
    <!--[if lt IE 9]>
			<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
			<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
		<![endif]-->

    
  </head>

  <body>
    <div id="wrap">

      
      <nav class="navbar navbar-default">
  <div class="container">
    <div class="navbar-header">
      <a class="navbar-brand" href="../../"><i class="fa fa-home"></i></a>
    </div>
    <div id="navbar">
      <ul class="nav navbar-nav navbar-right">
      
        
        <li><a href="../../blog/">BLOG</a></li>
        
        <li><a href="../../research/">RESEARCH</a></li>
        
      
      </ul>
    </div>
  </div>
</nav>

      
      <div class="container">
        <div class="blog-post">
          <h3>
            <strong><a href="../../blog/latex-notation-for-scientific-notation-in-ggplot2/">LaTeX Notation for Scientific Notation in ggplot2</a></strong>
          </h3>
        </div>
        <div class="blog-title">
          <h4>
          January 30, 2022
            &nbsp;&nbsp;
            
            <span class="label label-tag">ggplot2</span>
            
            <span class="label label-tag">LaTeX</span>
            
          </h4>
        </div>
        <div class="panel panel-default">
          <div class="panel-body">
            <div class="blogpost">
              


<p>A while ago I was tinkering with a plot and realised that tweaking the scientific notation format would improve the look of the final image. We can start by loading our packages and producing an example plot to see what the problem we need to fix is.</p>
<pre class="r"><code>library(tidyverse)
# change the unemployment figures so they aren&#39;t in thousands
economics &lt;- mutate(economics, unemploy = unemploy * 1000) 
ggplot(economics, aes(x = date, y = unemploy)) +
  geom_line()</code></pre>
<p><img src="../../blog/latex-notation-for-scientific-notation-in-ggplot2/index_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>The scientific notation is perfectly sensible but the <code>e+08</code> notation isn’t great. This led me to look for a way of changing the <code>e+08</code> to a LaTeX notation of <span class="math inline">\(\times 10^8\)</span>. After a quick google I came to <a href="https://stackoverflow.com/questions/10762287/how-can-i-format-axis-labels-with-exponents-with-ggplot2-and-scales" target="_blank">this stackoverflow post</a>. This gives us</p>
<pre class="r"><code>scientific_10 &lt;- function(x) {
  parse(text=gsub(&quot;e&quot;, &quot; %*% 10^&quot;, scales::scientific_format()(x)))
}</code></pre>
<p>and we can use it with <code>ggplot2</code> as such.</p>
<pre class="r"><code>ggplot(economics, aes(x = date, y = unemploy)) +
  geom_line() +
  scale_y_continuous(label=scientific_10)</code></pre>
<p><img src="../../blog/latex-notation-for-scientific-notation-in-ggplot2/index_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>This is pretty much perfect already but as you can see from the example in the stackoverflow post</p>
<pre class="r"><code>library(patchwork)
x &lt;- 1:4
y &lt;- c(0, 0.0001, 0.0002, 0.0003)

dd &lt;- data.frame(x, y)

before &lt;- ggplot(dd, aes(x, y)) + 
  geom_point() +
  ggtitle(&quot;Before&quot;)

after &lt;- ggplot(dd, aes(x, y)) + 
  geom_point() +
  scale_y_continuous(label = scientific_10) +
  ggtitle(&quot;After&quot;)

before + after</code></pre>
<p><img src="../../blog/latex-notation-for-scientific-notation-in-ggplot2/index_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>the <code>0e+00</code> should really just be <code>0</code> and not need any work done. I also think that the <code>gsub()</code> notation isn’t that readable. Therefore I rewrote the function to strip out the <code>e+00</code> from the <code>0</code> and use <code>stringr</code> functions and the pipe because I’d likely have the <code>tidyverse</code> loaded anyway.</p>
<pre class="r"><code>scientific_10 &lt;- function(x) {
  scales::scientific_format()(x) %&gt;% 
    str_remove_all(&quot;e\\+00&quot;) %&gt;% # strip e+00 as we don&#39;t need it
    str_replace_all(&quot;e&quot;, &quot; %*% 10^&quot;) %&gt;%
    parse(text = .)
}</code></pre>
<p>This still works great with the economics dataset</p>
<pre class="r"><code>ggplot(economics, aes(x = date, y = unemploy)) +
  geom_line() +
  scale_y_continuous(label=scientific_10)</code></pre>
<p><img src="../../blog/latex-notation-for-scientific-notation-in-ggplot2/index_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>but it also fixes the issue with 0.</p>
<pre class="r"><code>after &lt;- ggplot(dd, aes(x, y)) + 
  geom_point() +
  scale_y_continuous(label = scientific_10) +
  ggtitle(&quot;After&quot;)

before + after</code></pre>
<p><img src="../../blog/latex-notation-for-scientific-notation-in-ggplot2/index_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>For anyone wanting to use base <code>R</code> here is a version with no <code>stringr</code> dependencies or the pipe.</p>
<pre class="r"><code>scientific_10_base &lt;- function(x) {
  sci_form &lt;- scales::scientific_format()(x)
  # strip e+00 as we don&#39;t need it
  zero_fix &lt;- gsub(&quot;e\\+00&quot;, &quot;&quot;, sci_form)
  latex_not &lt;- gsub(&quot;e&quot;, &quot; %*% 10^&quot;, zero_fix) 
  
  # return parsed version
  return(parse(text = latex_not))
}</code></pre>
<pre class="r"><code>after &lt;- ggplot(dd, aes(x, y)) + 
  geom_point() +
  scale_y_continuous(label = scientific_10_base) +
  ggtitle(&quot;After&quot;)

before + after</code></pre>
<p><img src="../../blog/latex-notation-for-scientific-notation-in-ggplot2/index_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>Clearly, this works just as well as the <code>stringr</code> version so feel free to use either. I find the <code>stringr</code> version easier to read and hopefully remember what it does when I come back to it at some point.</p>

            
            </div>
          </div>
          <hr>
       
        </div>
      </div>
      
    </div>

    
    <footer>
  <div id="footer">
    <div class="container">
      <p class="text-muted">&copy; All rights reserved. Powered by <a href="https://github.com/rstudio/blogdown" target = "_blank">Blogdown</a>, <a href="https://gohugo.io/" target = "_blank">Hugo</a> and
      <a href="http://www.github.com/nurlansu/hugo-sustain/" target = "_blank">sustain</a> with ♥</p>
    </div>
  </div>
</footer>
<div class="footer"></div>
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
      }
    });
    </script>
    <script type="text/javascript"
      src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script src="../../js/docs.min.js"></script>
<script src="../../js/main.js"></script>

<script src="../../js/ie10-viewport-bug-workaround.js"></script><!-- Syntax highlighting -->
<script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/r.min.js"></script>
<script>
hljs.configure({languages: []});
hljs.initHighlightingOnLoad();
</script>



    
  </body>
</html>
