---
title: using plotly to generate interactive 3d plots
author: ''
date: '2018-05-12'
slug: using-plotly-to-generate-interactive-3d-plots
categories:
  - R
tags:
  - plotly
highlight: true
description: ''
---

<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/rmarkdown-libs/plotly-binding/plotly.js"></script>
<script src="/rmarkdown-libs/typedarray/typedarray.min.js"></script>
<script src="/rmarkdown-libs/jquery/jquery.min.js"></script>
<link href="/rmarkdown-libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="/rmarkdown-libs/crosstalk/js/crosstalk.min.js"></script>
<link href="/rmarkdown-libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="/rmarkdown-libs/plotly-main/plotly-latest.min.js"></script>


<p>One of the courses I teach is a degree module which includes an introduction to solving ordinary differential equations (ODEs) numerically using <code>R</code>. I make heavy use of the <a href="http://desolve.r-forge.r-project.org/">deSolve</a> package and normally plot results with <a href="http://ggplot2.tidyverse.org/">ggplot2</a> but one of the models we look at is a 2/3 body problem and we generate results in 3d. At the moment we’ve been using <a href="https://cran.r-project.org/web/packages/scatterplot3d/vignettes/s3d.pdf">scatterplot3d</a> as it’s pretty easy to use but it is kind of lacking something when it comes to helping students see what is happening. You can change the angle you want to look at it but need to redraw the plot each time - which brings me onto <a href="https://plot.ly/r/">plotly</a>.</p>
<p>Recently I’ve been using it in some <a href="https://shiny.aj2duncan.com">shiny</a> apps and rather than using <code>ggplotly()</code>, plotting in it directly <a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>. This led me to look at the documentation a little more closely and discover how simple it is to produce a 3d scatterplot.</p>
<p>If we model a 3-body problem where one body moves directly upwards and the other two rotate around it then the results end of in the <em>long</em> form shown below.</p>
<pre><code>  body x y     z
1  one 0 0 0.000
2  one 0 0 0.025
3  one 0 0 0.050
4  one 0 0 0.075
5  one 0 0 0.100
6  one 0 0 0.125</code></pre>
<p>Producing the plot then requires a relatively small amount on code.</p>
<pre class="r"><code>library(plotly)
plot_ly(results, x = ~x, y = ~y, z = ~z, color = ~body, colors = &quot;Set1&quot;) %&gt;%
  add_markers() %&gt;%
  layout(title = &quot;Three Body System&quot;)</code></pre>
<div id="htmlwidget-1" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"visdat":{"1c105281502c":["function () ","plotlyVisDat"]},"cur_data":"1c105281502c","attrs":{"1c105281502c":{"x":{},"y":{},"z":{},"color":{},"colors":"Set1","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Three Body System","scene":{"xaxis":{"title":"x"},"yaxis":{"title":"y"},"zaxis":{"title":"z"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"y":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"z":[0,0.025,0.05,0.075,0.1,0.125,0.15,0.175,0.2,0.225,0.25,0.275,0.3,0.325,0.35,0.375,0.4,0.425,0.45,0.475,0.5,0.525,0.55,0.575,0.6,0.625,0.65,0.675,0.7,0.725,0.75,0.775,0.8,0.825,0.85,0.875,0.9,0.925,0.95,0.975,1,1.025,1.05,1.075,1.1,1.125,1.15,1.175,1.2,1.225,1.25,1.275,1.3,1.325,1.35,1.375,1.4,1.425,1.45,1.475,1.5,1.525,1.55,1.575,1.6,1.625,1.65,1.675,1.7,1.725,1.75,1.775,1.8,1.825,1.85,1.875,1.9,1.925,1.95,1.975,2,2.025,2.05,2.075,2.1,2.125,2.15,2.175,2.2,2.225,2.25,2.275,2.3,2.325,2.35,2.375,2.4,2.425,2.45,2.475,2.5,2.525,2.55,2.575,2.6,2.625,2.65,2.675,2.7,2.725,2.75,2.775,2.8,2.825,2.85,2.875,2.9,2.925,2.95,2.975,3,3.025,3.05,3.075,3.1,3.125],"type":"scatter3d","mode":"markers","name":"one","marker":{"color":"rgba(228,26,28,1)","line":{"color":"rgba(228,26,28,1)"}},"textfont":{"color":"rgba(228,26,28,1)"},"error_y":{"color":"rgba(228,26,28,1)"},"error_x":{"color":"rgba(228,26,28,1)"},"line":{"color":"rgba(228,26,28,1)"},"frame":null},{"x":[-1,-0.998437662570437,-0.993752609173957,-0.98595074508547,-0.975042014968832,-0.961040558238725,-0.943964929687455,-0.923838388518296,-0.900689259850845,-0.874551373698982,-0.845464587360613,-0.813475398084643,-0.778637653767853,-0.741013370240757,-0.700673664364965,-0.657699812595681,-0.612184444736273,-0.564232882155244,-0.513964628517006,-0.461515018789485,-0.407037028534778,-0.350703239757396,-0.292707951251937,-0.233269409709712,-0.172632121957366,-0.111069187699124,-0.0488845651533169,0.0135848516225108,0.0759675052516788,0.13785600516496,0.198806772865064,0.258340808593744,0.315945925849468,0.371080820884068,0.423181331172195,0.471669173405518,0.515963321975109,0.555493982789772,0.589718836169914,0.618140886582212,0.640326909034566,0.655925185876713,0.66468105776272,0.666448834031332,0.66119885431333,0.649018948440602,0.630110135690574,0.604777028423696,0.573413941996732,0.53648806998955,0.494521217212469,0.44807150265785,0.397716202703746,0.344036574054912,0.287605147094637,0.228975667694756,0.16867562044943,0.107201098899455,0.0450136933461103,-0.0174609694971228,-0.0798333951390277,-0.141749426398382,-0.202888767535201,-0.262963060026669,-0.32171369416099,-0.378909497139767,-0.434344401360866,-0.487835166297454,-0.539219203476272,-0.588352535710763,-0.635107908057878,-0.679373058049288,-0.721049145792653,-0.760049339858259,-0.796297551894944,-0.829727311205746,-0.860280769706697,-0.887907827523724,-0.912565369751966,-0.934216605461514,-0.95283050077736,-0.968381298714236,-0.980848119357875,-0.990214634919157,-0.996468815125959,-0.999602739347607,-0.999612472763952,-0.996498004794878,-0.990263248899479,-0.980916103741874,-0.968468576608346,-0.952936970853868,-0.934342140059746,-0.912709812501142,-0.888070990453197,-0.860462429802791,-0.82992720636793,-0.796515376237826,-0.760284738300079,-0.721301707866064,-0.67964231086677,-0.635393308362977,-0.588653460948652,-0.539534941824375,-0.488164905611164,-0.434687217013399,-0.37926433877223,-0.322079371413158,-0.26333822739571,-0.203271908614516,-0.142138837888086,-0.0802271711992951,-0.0178569872402546,0.0446177861583625,0.106807892575235,0.16828794678758,0.228596596059318,0.287237970817352,0.343684784689966,0.397383449733121,0.447761536655767,0.494237815331605,0.536234944002521,0.573194631006699,0.604594780615488,0.629967785841872],"y":[0,-0.0499739522107557,-0.0997915567917558,-0.14929607591312,-0.198329992601282,-0.246734624510078,-0.294349742111508,-0.341013193479448,-0.386560538479051,-0.430824696024589,-0.473635609164711,-0.514819934141181,-0.554200761299401,-0.591597377870756,-0.626825085272429,-0.659695086763463,-0.690014465146618,-0.717586274805883,-0.74220977780437,-0.763680860100087,-0.781792671187805,-0.796336538586581,-0.807103217382046,-0.813884544125307,-0.816475573130055,-0.814677280545037,-0.808299925932443,-0.797167160208456,-0.781120959670518,-0.760027444591713,-0.733783602947609,-0.702324880401647,-0.665633512408532,-0.623747360870139,-0.576768877890568,-0.524873661068945,-0.468317905683608,-0.407443926652086,-0.342682854012685,-0.274553640396796,-0.203657691829116,-0.130668758678004,-0.0563181832246599,0.0186238638280723,0.0933700051719819,0.167138584520082,0.239176157440763,0.308777866884528,0.375304328009817,0.438194119482509,0.496971519433395,0.551249631930724,0.600729447597585,0.64519563169149,0.684509933847795,0.718603091871404,0.74746599636456,0.771140733201385,0.789711959465066,0.803298917859471,0.81204826729956,0.816127808036738,0.815721107688955,0.811022986392599,0.802235790258794,0.789566367618851,0.773223657943401,0.753416805369116,0.730353714837266,0.704239977042478,0.675278097409068,0.64366697331679,0.609601572283771,0.573272771512099,0.534867325997984,0.494567938289434,0.452553407985243,0.408998843285912,0.364075920419802,0.317953179668212,0.270796349088518,0.222768688964184,0.174031351563925,0.124743752028781,0.0750639471747755,0.0251490197403975,-0.0248445338462389,-0.0747604137321904,-0.124442126270231,-0.17373259427712,-0.22247376925244,-0.270506247107725,-0.317668889328005,-0.363798452032349,-0.408729226140125,-0.452292692816978,-0.494317199609097,-0.534627664225462,-0.573045314854736,-0.609387478275639,-0.64346742991619,-0.675094323525473,-0.704073222333298,-0.730205258578282,-0.753287954159768,-0.773115741959098,-0.789480735067417,-0.802173799638258,-0.810985996085136,-0.815710462365227,-0.816144821293072,-0.812094199917821,-0.803374951081086,-0.789819162726768,-0.771280025916733,-0.747638103583051,-0.718808494039033,-0.684748811458903,-0.645467806378485,-0.601034322142678,-0.551586132748398,-0.497338046149558,-0.438588507141339,-0.375723827924922,-0.309219151942334,-0.239635356526518],"z":[0,0.025,0.05,0.075,0.1,0.125,0.15,0.175,0.2,0.225,0.25,0.275,0.3,0.325,0.35,0.375,0.4,0.425,0.45,0.475,0.5,0.525,0.55,0.575,0.6,0.625,0.65,0.675,0.7,0.725,0.75,0.775,0.8,0.825,0.85,0.875,0.9,0.925,0.95,0.975,1,1.025,1.05,1.075,1.1,1.125,1.15,1.175,1.2,1.225,1.25,1.275,1.3,1.325,1.35,1.375,1.4,1.425,1.45,1.475,1.5,1.525,1.55,1.575,1.6,1.625,1.65,1.675,1.7,1.725,1.75,1.775,1.8,1.825,1.85,1.875,1.9,1.925,1.95,1.975,2,2.025,2.05,2.075,2.1,2.125,2.15,2.175,2.2,2.225,2.25,2.275,2.3,2.325,2.35,2.375,2.4,2.425,2.45,2.475,2.5,2.525,2.55,2.575,2.6,2.625,2.65,2.675,2.7,2.725,2.75,2.775,2.8,2.825,2.85,2.875,2.9,2.925,2.95,2.975,3,3.025,3.05,3.075,3.1,3.125],"type":"scatter3d","mode":"markers","name":"two","marker":{"color":"rgba(255,127,0,1)","line":{"color":"rgba(255,127,0,1)"}},"textfont":{"color":"rgba(255,127,0,1)"},"error_y":{"color":"rgba(255,127,0,1)"},"error_x":{"color":"rgba(255,127,0,1)"},"line":{"color":"rgba(255,127,0,1)"},"frame":null},{"x":[1,0.998437662570437,0.993752609173957,0.98595074508547,0.975042014968832,0.961040558238725,0.943964929687455,0.923838388518296,0.900689259850845,0.874551373698982,0.845464587360613,0.813475398084643,0.778637653767853,0.741013370240757,0.700673664364965,0.657699812595681,0.612184444736273,0.564232882155244,0.513964628517006,0.461515018789485,0.407037028534778,0.350703239757396,0.292707951251937,0.233269409709712,0.172632121957366,0.111069187699124,0.0488845651533169,-0.0135848516225108,-0.0759675052516788,-0.13785600516496,-0.198806772865064,-0.258340808593744,-0.315945925849468,-0.371080820884068,-0.423181331172195,-0.471669173405518,-0.515963321975109,-0.555493982789772,-0.589718836169914,-0.618140886582212,-0.640326909034566,-0.655925185876713,-0.66468105776272,-0.666448834031332,-0.66119885431333,-0.649018948440602,-0.630110135690574,-0.604777028423696,-0.573413941996732,-0.53648806998955,-0.494521217212469,-0.44807150265785,-0.397716202703746,-0.344036574054912,-0.287605147094637,-0.228975667694756,-0.16867562044943,-0.107201098899455,-0.0450136933461103,0.0174609694971228,0.0798333951390277,0.141749426398382,0.202888767535201,0.262963060026669,0.32171369416099,0.378909497139767,0.434344401360866,0.487835166297454,0.539219203476272,0.588352535710763,0.635107908057878,0.679373058049288,0.721049145792653,0.760049339858259,0.796297551894944,0.829727311205746,0.860280769706697,0.887907827523724,0.912565369751966,0.934216605461514,0.95283050077736,0.968381298714236,0.980848119357875,0.990214634919157,0.996468815125959,0.999602739347607,0.999612472763952,0.996498004794878,0.990263248899479,0.980916103741874,0.968468576608346,0.952936970853868,0.934342140059746,0.912709812501142,0.888070990453197,0.860462429802791,0.82992720636793,0.796515376237826,0.760284738300079,0.721301707866064,0.67964231086677,0.635393308362977,0.588653460948652,0.539534941824375,0.488164905611164,0.434687217013399,0.37926433877223,0.322079371413158,0.26333822739571,0.203271908614516,0.142138837888086,0.0802271711992951,0.0178569872402546,-0.0446177861583625,-0.106807892575235,-0.16828794678758,-0.228596596059318,-0.287237970817352,-0.343684784689966,-0.397383449733121,-0.447761536655767,-0.494237815331605,-0.536234944002521,-0.573194631006699,-0.604594780615488,-0.629967785841872],"y":[0,0.0499739522107557,0.0997915567917558,0.14929607591312,0.198329992601282,0.246734624510078,0.294349742111508,0.341013193479448,0.386560538479051,0.430824696024589,0.473635609164711,0.514819934141181,0.554200761299401,0.591597377870756,0.626825085272429,0.659695086763463,0.690014465146618,0.717586274805883,0.74220977780437,0.763680860100087,0.781792671187805,0.796336538586581,0.807103217382046,0.813884544125307,0.816475573130055,0.814677280545037,0.808299925932443,0.797167160208456,0.781120959670518,0.760027444591713,0.733783602947609,0.702324880401647,0.665633512408532,0.623747360870139,0.576768877890568,0.524873661068945,0.468317905683608,0.407443926652086,0.342682854012685,0.274553640396796,0.203657691829116,0.130668758678004,0.0563181832246599,-0.0186238638280723,-0.0933700051719819,-0.167138584520082,-0.239176157440763,-0.308777866884528,-0.375304328009817,-0.438194119482509,-0.496971519433395,-0.551249631930724,-0.600729447597585,-0.64519563169149,-0.684509933847795,-0.718603091871404,-0.74746599636456,-0.771140733201385,-0.789711959465066,-0.803298917859471,-0.81204826729956,-0.816127808036738,-0.815721107688955,-0.811022986392599,-0.802235790258794,-0.789566367618851,-0.773223657943401,-0.753416805369116,-0.730353714837266,-0.704239977042478,-0.675278097409068,-0.64366697331679,-0.609601572283771,-0.573272771512099,-0.534867325997984,-0.494567938289434,-0.452553407985243,-0.408998843285912,-0.364075920419802,-0.317953179668212,-0.270796349088518,-0.222768688964184,-0.174031351563925,-0.124743752028781,-0.0750639471747755,-0.0251490197403975,0.0248445338462389,0.0747604137321904,0.124442126270231,0.17373259427712,0.22247376925244,0.270506247107725,0.317668889328005,0.363798452032349,0.408729226140125,0.452292692816978,0.494317199609097,0.534627664225462,0.573045314854736,0.609387478275639,0.64346742991619,0.675094323525473,0.704073222333298,0.730205258578282,0.753287954159768,0.773115741959098,0.789480735067417,0.802173799638258,0.810985996085136,0.815710462365227,0.816144821293072,0.812094199917821,0.803374951081086,0.789819162726768,0.771280025916733,0.747638103583051,0.718808494039033,0.684748811458903,0.645467806378485,0.601034322142678,0.551586132748398,0.497338046149558,0.438588507141339,0.375723827924922,0.309219151942334,0.239635356526518],"z":[0,0.025,0.05,0.075,0.1,0.125,0.15,0.175,0.2,0.225,0.25,0.275,0.3,0.325,0.35,0.375,0.4,0.425,0.45,0.475,0.5,0.525,0.55,0.575,0.6,0.625,0.65,0.675,0.7,0.725,0.75,0.775,0.8,0.825,0.85,0.875,0.9,0.925,0.95,0.975,1,1.025,1.05,1.075,1.1,1.125,1.15,1.175,1.2,1.225,1.25,1.275,1.3,1.325,1.35,1.375,1.4,1.425,1.45,1.475,1.5,1.525,1.55,1.575,1.6,1.625,1.65,1.675,1.7,1.725,1.75,1.775,1.8,1.825,1.85,1.875,1.9,1.925,1.95,1.975,2,2.025,2.05,2.075,2.1,2.125,2.15,2.175,2.2,2.225,2.25,2.275,2.3,2.325,2.35,2.375,2.4,2.425,2.45,2.475,2.5,2.525,2.55,2.575,2.6,2.625,2.65,2.675,2.7,2.725,2.75,2.775,2.8,2.825,2.85,2.875,2.9,2.925,2.95,2.975,3,3.025,3.05,3.075,3.1,3.125],"type":"scatter3d","mode":"markers","name":"three","marker":{"color":"rgba(153,153,153,1)","line":{"color":"rgba(153,153,153,1)"}},"textfont":{"color":"rgba(153,153,153,1)"},"error_y":{"color":"rgba(153,153,153,1)"},"error_x":{"color":"rgba(153,153,153,1)"},"line":{"color":"rgba(153,153,153,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>The plot can be rotated to see it from different perspectives and the tooltips automatically provide the coordinates of the points, all of which does seem to lend it a little more to enabling students to see what is happening. I will try it out the next time I teach the module and see what the feedback is. In the meantime I will continue to use <a href="https://plot.ly/r/">plotly</a>.</p>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>As an aside, it drastically speeded up plotting in a shiny app.<a href="#fnref1" class="footnote-back">↩</a></p></li>
</ol>
</div>
